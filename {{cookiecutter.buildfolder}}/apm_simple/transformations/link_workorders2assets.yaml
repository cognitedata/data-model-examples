externalId: tutorial-load-workorders2assets
name: tutorial-load-Workorders2assets
query: >-
  /* MAPPING_MODE_ENABLED: true */
  /* {"version":1,"sourceType":"raw","mappings":[{"from":"externalId","to":"externalId","asType":"STRING"},{"from":"sourceExternalId","to":"startNode","asType":"STRUCT<`space`:STRING, `externalId`:STRING>"},{"to":"endNode","asType":"STRUCT<`space`:STRING, `externalId`:STRING>","from":"targetExternalId"}],"sourceLevel1":"{{cookiecutter.apm_simple_raw_db}}","sourceLevel2":"workorder2assets"} */
  select
    cast(`externalId` as STRING) as externalId,
    node_reference('{{cookiecutter.apm_simple_space}}', `sourceExternalId`) as startNode,
    node_reference('{{cookiecutter.apm_simple_space}}', `targetExternalId`) as endNode
  from
    `{{cookiecutter.apm_simple_raw_db}}`.`workorder2assets`;
destination:
  view:
    space: {{cookiecutter.apm_simple_space}}
    externalId: Workorder
    version: ""
  instanceSpace: {{cookiecutter.apm_simple_space}}
  type: nodes
ignoreNullFields: true
shared: true
action: upsert
# Specify credentials separately like this:
# You can also use different credentials for the running transformations than the ones you use to deploy
authentication:
  clientId: ${TRANSFORMATIONS_CLIENT_ID}
  clientSecret: ${TRANSFORMATIONS_CLIENT_SECRET}
  tokenUrl: ${TRANSFORMATIONS_TOKEN_URL}
  # Optional: If idP requires providing the scopes
  cdfProjectName: ${TRANSFORMATIONS_PROJECT}
  scopes:
    - ${TRANSFORMATIONS_SCOPES}
  # Optional: If idP requires providing the audience
  audience: ${TRANSFORMATIONS_AUDIENCE}
